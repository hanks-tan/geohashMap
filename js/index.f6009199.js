(function(t){function e(e){for(var a,i,r=e[0],c=e[1],l=e[2],d=0,h=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={index:0},s=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0c74":function(t,e,n){},2395:function(t,e,n){},"25ff":function(t,e,n){"use strict";n("c851")},"348d":function(t,e){},"46b2":function(t,e,n){},"50a4":function(t,e,n){"use strict";n("0c74")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("a026"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Main"),n("Foot")],1)},s=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("div",{staticClass:"map",attrs:{id:"map"}}),n("GH"),n("Search",{staticClass:"searchBar",on:{search:t.mapSearchHandle,close:t.clearPopHandle}}),n("Info",{ref:"tools",staticClass:"info"})],1)},r=[],c=(n("a15b"),n("e192")),l=n.n(c),u=n("5a74"),d=n.n(u),h=n("d4ec"),p=n("bee2"),f=(n("d81d"),n("eb43")),b=n.n(f),m=n("fc4e"),v=n.n(m);n("ac1f"),n("1276"),n("466d");function g(t,e){e||(e=",");var n=t.split(e).map((function(t){return parseInt(t)}));return n}function y(t){if(!t instanceof String)return!1;t=t.replaceAll(" ","");var e=/^[-\+]?\d+(\.\d+)?\,[-\+]?\d+(\.\d+)?$/,n=t.match(e);return n}function w(t){return!!b.a.decode(t)}function x(t){var e={geom:[[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]],[t[0],t[1]]]]};return v.a.parse([e],{Polygon:"geom"})}function C(t,e,n){var a=v.a.parse(t,{Point:[n,e]});return a}function j(t){if(navigator.clipboard.writeText(t),navigator.clipboard)navigator.clipboard.writeText(t);else{var e=document.createElement("textarea");document.body.appendChild(e),e.value=t,e.select(),document.execCommand&&document.execCommand("copy"),document.body.removeChild(e)}}function k(t){return decodeURIComponent(atob(t))}var S=function(){function t(e){var n=this;Object(h["a"])(this,t),this.map=e.map,this._layer=void 0,this.defaults={zoom:3,maxDisplay:10240,geohashPrecision:12,geohashZoomScale:[1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9]},this.gridParts=[],this.gridPoints=[],this._layers={},this.map&&this.map.on("load",(function(){n.init()}))}return Object(p["a"])(t,[{key:"init",value:function(){var t=this,e=this.getGridData();this.map.addSource("geohashPoint",{type:"geojson",data:e.point}),this.map.addSource("geohashGrid",{type:"geojson",data:e.box});var n={id:"geohashPointLayer",source:"geohashPoint",type:"symbol",layout:{"text-field":"{code}","text-anchor":"center","text-size":12}},a={id:"geohashGridLayer",source:"geohashGrid",type:"fill",layout:{},paint:{"fill-color":"#088","fill-opacity":.2,"fill-outline-color":"#007bff"}};this.map.addLayer(a),this.map.addLayer(n),this._layers={point:n,polygon:a},this.map.on("load",(function(){t.refreshData()})),this.map.on("moveend",(function(){t.refreshData()}))}},{key:"getGridData",value:function(){this.gridParts=[],this.gridPoints=[];var t=this.map.getZoom(),e=Math.round(t),n=this.defaults.geohashZoomScale[e],a=this.map.getBounds(),o=a.getWest(),s=a.getSouth(),i=a.getEast(),r=a.getNorth(),c=b.a.encode(r,i,n),l=b.a.encode(r,o,n),u=b.a.encode(s,o,n),d=(b.a.encode(s,i,n),c),h=c,p=l,f=this.defaults.maxDisplay;while(f-- >0){this.drawBox(d);do{d=b.a.adjacent(d,"w"),this.drawBox(d)}while(f-- >0&&d!=p);if(d==u){var m=v.a.parse(this.gridParts,{Polygon:"geom"}),g=C(this.gridPoints,"lng","lat");return{point:g,box:m}}p=b.a.adjacent(d,"s"),d=h=b.a.adjacent(h,"s")}alert("defaults.maxDisplay limit reached")}},{key:"drawBox",value:function(t){var e=b.a.bounds(t),n=(e.sw.lon,e.sw.lat,e.ne.lon,e.ne.lat,e.sw.lon),a=e.sw.lat,o=e.ne.lon,s=e.ne.lat,i={code:t,geom:[[[n,a],[o,a],[o,s],[n,s],[n,a]]]};this.gridParts.push(i);var r=b.a.decode(t),c={code:t,lng:r.lon,lat:r.lat};this.gridPoints.push(c)}},{key:"refreshData",value:function(){var t=this.getGridData();this.map.getSource("geohashGrid").setData(t.box),this.map.getSource("geohashPoint").setData(t.point)}}]),t}(),_=S,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mapInfo"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showSetting,expression:"showSetting"}],staticClass:"setting"},[n("span",[t._v("精度")]),n("el-input-number",{staticClass:"map-input",attrs:{"controls-position":"right",size:"mini",min:1,max:12},model:{value:t.precision,callback:function(e){t.precision=e},expression:"precision"}})],1),n("div",{staticClass:"content"},[n("div",[t._v(" 坐标:"+t._s(t.coord)+", ")]),n("div",[n("span",[t._v("geohash编码: "+t._s(t.geohashCode))]),n("div",{staticClass:"tools"},[n("Copy",{staticClass:"btn-items",attrs:{textStr:t.text}}),n("el-tooltip",{attrs:{content:"精度设置",placement:"top"}},[n("i",{staticClass:"el-icon-setting btn-item",on:{click:function(e){t.showSetting=!t.showSetting}}})])],1)])])])},M=[],I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"copyTool"},[n("el-tooltip",{attrs:{content:"复制",placement:"top"}},[n("i",{staticClass:"el-icon-document-copy btn-copy",on:{click:t.copyHandle}})])],1)},L=[],T={props:{textStr:{type:String,require:!0}},methods:{copyHandle:function(){j(this.textStr)}}},P=T,z=(n("25ff"),n("2877")),E=Object(z["a"])(P,I,L,!1,null,"3a63f9e4",null),N=E.exports,B={data:function(){return{geohashCode:"",coord:"",precision:5,showSetting:!1}},components:{Copy:N},computed:{text:function(){return"坐标:".concat(this.coord,",\n")+"geohash编码: ".concat(this.geohashCode)}},watch:{coord:function(t){this.convertCoordToCode(t)}},methods:{convertCoordToCode:function(t){if(t){var e=t.split(",").map((function(t){return parseFloat(t)}));this.geohashCode=b.a.encode(e[1],e[0],this.precision)}}}},D=B,H=(n("c42d"),Object(z["a"])(D,O,M,!1,null,"fbb2a1a6",null)),$=H.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"searchBox"},[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜geohash编码、经纬度"},on:{change:t.searchHandle},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},[n("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-search"},on:{click:t.searchHandle},slot:"append"})],1),t.boxInfoVisible?n("div",{staticClass:"searchResult"},[n("div",[n("i",{staticClass:"el-icon-close close",on:{click:t.closeHandle}})]),"geohashCode"===t.searchType?n("div",{staticClass:"content"},[n("li",[t._v("东经: "+t._s(t.bound.ne.lon)+"°")]),n("li",[t._v("西经: "+t._s(t.bound.sw.lon)+"°")]),n("li",[t._v("北纬: "+t._s(t.bound.ne.lat)+"°")]),n("li",[t._v("南纬: "+t._s(t.bound.sw.lat)+"°")]),n("Copy",{staticClass:"copyBar",attrs:{textStr:t.info}}),n("li",[t._v("中心点："+t._s(t.center.lon+"°, "+t.center.lat+"°"))])],1):"coord"===t.searchType?n("div",{staticClass:"content"},[n("span",[t._v(" geohash编码："+t._s(t.searchTextResult)+" ")]),n("Copy",{staticClass:"copyBar",attrs:{textStr:t.info}})],1):t._e()]):t._e()],1)},A=[],G=(n("99af"),{data:function(){return{input:"",bound:{},center:[],boxInfoVisible:!1,searchType:"",searchTextResult:""}},components:{Copy:N},computed:{info:function(){return"geohashcode"===this.searchType?"东经: ".concat(this.bound.ne.lon,"°\n")+"西经: ".concat(this.bound.sw.lon,"°\n")+"北纬: ".concat(this.bound.ne.lat,"°\n")+"南纬: ".concat(this.bound.sw.lat,"°\n")+"中心点：".concat(this.center.lon,"°, ").concat(this.center.lat,"°"):("coord"===this.searchType&&this.searchTextResult,"")}},watch:{boxInfoVisible:function(t){t||(this.bound={},this.center=[])}},methods:{searchHandle:function(){this.input&&(y(this.input)?this.searchType="coord":w(this.input)&&(this.searchType="geohashCode"),this.showBoxInfo(this.input,this.searchType),this.$emit("search",{type:this.searchType,data:this.input}))},showBoxInfo:function(t,e){if("coord"===e){var n=g(t);this.searchTextResult=b.a.encode(n[1],n[0])}else"geohashCode"===e&&(this.bound=b.a.bounds(t),this.center=b.a.decode(t));this.boxInfoVisible=!0},closeHandle:function(){this.boxInfoVisible=!1,this.$emit("close")}}}),J=G,U=(n("50a4"),Object(z["a"])(J,q,A,!1,null,"3d4b5bdc",null)),R=U.exports,F=n("95d1"),V={data:function(){return{mapObj:null,markers:{searchMarker:null,evtMarker:null},markerColors:{searchMarker:"#f74e4e",evtMarker:"#3FB1CE"},boxSourceId:"boxSource"}},components:{Info:$,Search:R,GH:F["default"]},mounted:function(){this.init()},methods:{init:function(){var t=this;l.a.accessToken="pk.eyJ1IjoiaGlrZXI3IiwiYSI6ImNqd2J1bnAzMTAydmEzenBsYWNsdmNtbnEifQ.yIals3oQAWta-jougYrCNQ",l.a.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.1.0/mapbox-gl-rtl-text.js");var e=new l.a.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v10",center:[108.902344,33.661133],zoom:3,attributionControl:!1}),n=new d.a({defaultLanguage:"zh"});e.addControl(n),this.mapObj=e;new _({map:e});e.on("click",(function(e){t.dispatchEventMapClick(e)}))},addPopBoxLayer:function(t){var e={type:"geojson",data:t};this.mapObj.addSource(this.boxSourceId,e);var n={id:"searchBox",type:"fill",source:this.boxSourceId,layout:{},paint:{"fill-color":"#409eff","fill-opacity":.3}};this.mapObj.addLayer(n)},dispatchEventMapClick:function(t){this.$refs.tools&&(this.$refs.tools.coord=t.lngLat.toArray().join(",")),this.showMarker(t.lngLat,"evtMarker")},mapSearchHandle:function(t){if("coord"===t.type){var e=g(t.data);this.showMarker(e,"searchMarker"),this.mapObj.flyTo({center:e,zoom:10})}else if("geohashCode"===t.type){var n=b.a.decode(t.data);if(n){var a=b.a.bounds(t.data),o=[a.sw.lon,a.sw.lat,a.ne.lon,a.ne.lat];this.showBox(o),this.mapObj.fitBounds([a.sw,a.ne],{padding:{top:25,bottom:25,left:15,right:15}})}}},showBox:function(t){var e=x(t);this.mapObj.getSource(this.boxSourceId)?this.mapObj.getSource(this.boxSourceId).setData(e):this.addPopBoxLayer(e)},showMarker:function(t,e){this.markers[e]?this.markers[e].setLngLat(t):this.markers[e]=new l.a.Marker({color:this.markerColors[e]}).setLngLat(t).addTo(this.mapObj)},clearPopHandle:function(t){if(this.markers[t.type]&&this.markers[t.type].remove(),this.mapObj.getSource(this.boxSourceId)){var e="wq517dd923zz",n=b.a.bounds(e),a=[n.sw.lon,n.sw.lat,n.ne.lon,n.ne.lat],o=x(a);this.mapObj.getSource(this.boxSourceId).setData(o)}}}},Z=V,Q=(n("6110"),Object(z["a"])(Z,i,r,!1,null,"478a52c6",null)),W=Q.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.aw?n("div",{staticClass:"icp"},[n("a",{attrs:{href:"http://beian.miit.gov.cn/"}},[t._v(t._s(t.icpKey[0]))])]):t._e()},Y=[],X={data:function(){return{aw:"",key1:"JUU3JUIyJUE0SUNQJUU1JUE0JTg3MjAyMDEyOTMxOSVFNSU4RiVCNw==",key2:"aHR0cDovL2JlaWFuLm1paXQuZ292LmNu",icpKey:[]}},watch:{aw:function(t){t&&(this.icpKey=[this.key1,this.key1].map((function(t){return k(t)})))}},mounted:function(){this.init()},methods:{init:function(){this.aw=1}}},tt=X,et=(n("b2dd"),Object(z["a"])(tt,K,Y,!1,null,"96b0806c",null)),nt=et.exports,at={name:"app",components:{Main:W,Foot:nt}},ot=at,st=(n("7c55"),Object(z["a"])(ot,o,s,!1,null,null,null)),it=st.exports,rt=(n("ac6d"),n("0c67"),n("450d"),n("299c")),ct=n.n(rt),lt=(n("1951"),n("eedf")),ut=n.n(lt),dt=(n("9d4c"),n("e450")),ht=n.n(dt),pt=(n("10cb"),n("f3ad")),ft=n.n(pt),bt=(n("f4f9"),n("c2cc")),mt=n.n(bt),vt=(n("7a0f"),n("0f6c")),gt=n.n(vt);n("0fae");a["default"].use(gt.a),a["default"].use(mt.a),a["default"].use(ft.a),a["default"].use(ht.a),a["default"].use(ut.a),a["default"].use(ct.a),a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(it)}}).$mount("#app")},5758:function(t,e,n){"use strict";var a=n("348d"),o=n.n(a);e["default"]=o.a},6110:function(t,e,n){"use strict";n("eb12")},"7c55":function(t,e,n){"use strict";n("2395")},8574:function(t,e,n){},9383:function(t,e,n){},"95d1":function(t,e,n){"use strict";var a=n("a86b"),o=n("5758"),s=(n("d78d"),n("2877")),i=Object(s["a"])(o["default"],a["a"],a["b"],!1,null,null,null);e["default"]=i.exports},a86b:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a",{staticClass:"github-corner",attrs:{href:"https://github.com/hanks-tan/geohashMap","aria-label":"View source on GitHub"}},[n("svg",{staticStyle:{fill:"#64CEAA",color:"#000",position:"absolute",top:"0",border:"0",right:"0"},attrs:{width:"80",height:"80",viewBox:"0 0 250 250","aria-hidden":"true"}},[n("path",{attrs:{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}}),n("path",{staticClass:"octo-arm",staticStyle:{"transform-origin":"130px 106px"},attrs:{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}}),n("path",{staticClass:"octo-body",attrs:{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"}})])])])},o=[]},b2dd:function(t,e,n){"use strict";n("9383")},c42d:function(t,e,n){"use strict";n("8574")},c851:function(t,e,n){},d78d:function(t,e,n){"use strict";n("46b2")},eb12:function(t,e,n){},eb43:function(t,e,n){"use strict";var a,o;n("a9e3"),n("b680"),n("fb6a");var s={base32:"0123456789bcdefghjkmnpqrstuvwxyz",encode:function(t,e,n){if("undefined"==typeof n){for(var a=1;a<=12;a++){var o=s.encode(t,e,a),i=s.decode(o);if(i.lat==t&&i.lon==e)return o}n=12}if(t=Number(t),e=Number(e),n=Number(n),isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Invalid geohash");var r=0,c=0,l=!0,u="",d=-90,h=90,p=-180,f=180;while(u.length<n){if(l){var b=(p+f)/2;e>b?(r=2*r+1,p=b):(r*=2,f=b)}else{var m=(d+h)/2;t>m?(r=2*r+1,d=m):(r*=2,h=m)}l=!l,5==++c&&(u+=s.base32.charAt(r),c=0,r=0)}return u},decode:function(t){var e=s.bounds(t),n=e.sw.lat,a=e.sw.lon,o=e.ne.lat,i=e.ne.lon,r=(n+o)/2,c=(a+i)/2;return r=r.toFixed(Math.floor(2-Math.log(o-n)/Math.LN10)),c=c.toFixed(Math.floor(2-Math.log(i-a)/Math.LN10)),{lat:Number(r),lon:Number(c)}},bounds:function(t){if(0===t.length)throw new Error("Invalid geohash");t=t.toLowerCase();for(var e=!0,n=-90,a=90,o=-180,i=180,r=0;r<t.length;r++){var c=t.charAt(r),l=s.base32.indexOf(c);if(-1==l)throw new Error("Invalid geohash");for(var u=4;u>=0;u--){var d=l>>u&1;if(e){var h=(o+i)/2;1==d?o=h:i=h}else{var p=(n+a)/2;1==d?n=p:a=p}e=!e}}var f={sw:{lat:n,lon:o},ne:{lat:a,lon:i}};return f},adjacent:function(t,e){if(t=t.toLowerCase(),e=e.toLowerCase(),0===t.length)throw new Error("Invalid geohash");if(-1=="nsew".indexOf(e))throw new Error("Invalid direction");var n={n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]},a={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]},o=t.slice(-1),i=t.slice(0,-1),r=t.length%2;return-1!=a[e][r].indexOf(o)&&""!==i&&(i=s.adjacent(i,e)),i+s.base32.charAt(n[e][r].indexOf(o))},neighbours:function(t){return{n:s.adjacent(t,"n"),ne:s.adjacent(s.adjacent(t,"n"),"e"),e:s.adjacent(t,"e"),se:s.adjacent(s.adjacent(t,"s"),"e"),s:s.adjacent(t,"s"),sw:s.adjacent(s.adjacent(t,"s"),"w"),w:s.adjacent(t,"w"),nw:s.adjacent(s.adjacent(t,"n"),"w")}}};t.exports&&(t.exports=s),a=[],o=function(){return s}.apply(e,a),void 0===o||(t.exports=o)}});