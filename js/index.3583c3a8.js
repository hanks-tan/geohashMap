(function(t){function e(e){for(var o,s,r=e[0],c=e[1],l=e[2],d=0,h=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&h.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,r=1;r<n.length;r++){var c=n[r];0!==a[c]&&(o=!1)}o&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},a={index:0},i=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},2395:function(t,e,n){},"25ff":function(t,e,n){"use strict";n("c851")},4976:function(t,e,n){"use strict";n("5958")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("a026"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Main"),n("Foot")],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("div",{staticClass:"map",attrs:{id:"map"}}),n("Search",{staticClass:"searchBar",on:{search:t.mapSearchHandle,close:t.clearPopHandle}}),n("Info",{ref:"tools",staticClass:"info"})],1)},r=[],c=(n("a15b"),n("e192")),l=n.n(c),u=n("5a74"),d=n.n(u),h=n("d4ec"),p=n("bee2"),f=(n("d81d"),n("eb43")),m=n.n(f),b=n("fc4e"),v=n.n(b);n("ac1f"),n("1276");function g(t,e){e||(e=",");var n=t.split(e).map((function(t){return parseInt(t)}));return n}function y(t){return t.indexOf(",")>-1}function w(t){return!!m.a.decode(t)}function x(t){var e={geom:[[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]],[t[0],t[1]]]]};return v.a.parse([e],{Polygon:"geom"})}function j(t,e,n){var o=v.a.parse(t,{Point:[n,e]});return o}function C(t){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t,e.select(),document.execCommand&&document.execCommand("copy"),document.body.removeChild(e)}function S(t){return decodeURIComponent(atob(t))}var _=function(){function t(e){var n=this;Object(h["a"])(this,t),this.map=e.map,this._layer=void 0,this.defaults={zoom:3,maxDisplay:10240,geohashPrecision:12,geohashZoomScale:[1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9]},this.gridParts=[],this.gridPoints=[],this._layers={},this.map&&this.map.on("load",(function(){n.init()}))}return Object(p["a"])(t,[{key:"init",value:function(){var t=this,e=this.getGridData();this.map.addSource("geohashPoint",{type:"geojson",data:e.point}),this.map.addSource("geohashGrid",{type:"geojson",data:e.box});var n={id:"geohashPointLayer",source:"geohashPoint",type:"symbol",layout:{"text-field":"{code}","text-anchor":"center","text-size":12}},o={id:"geohashGridLayer",source:"geohashGrid",type:"fill",layout:{},paint:{"fill-color":"#088","fill-opacity":.2,"fill-outline-color":"#007bff"}};this.map.addLayer(o),this.map.addLayer(n),this._layers={point:n,polygon:o},this.map.on("load",(function(){t.refreshData()})),this.map.on("moveend",(function(){t.refreshData()}))}},{key:"getGridData",value:function(){this.gridParts=[],this.gridPoints=[];var t=this.map.getZoom(),e=Math.round(t),n=this.defaults.geohashZoomScale[e],o=this.map.getBounds(),a=o.getWest(),i=o.getSouth(),s=o.getEast(),r=o.getNorth(),c=m.a.encode(r,s,n),l=m.a.encode(r,a,n),u=m.a.encode(i,a,n),d=(m.a.encode(i,s,n),c),h=c,p=l,f=this.defaults.maxDisplay;while(f-- >0){this.drawBox(d);do{d=m.a.adjacent(d,"w"),this.drawBox(d)}while(f-- >0&&d!=p);if(d==u){var b=v.a.parse(this.gridParts,{Polygon:"geom"}),g=j(this.gridPoints,"lng","lat");return{point:g,box:b}}p=m.a.adjacent(d,"s"),d=h=m.a.adjacent(h,"s")}alert("defaults.maxDisplay limit reached")}},{key:"drawBox",value:function(t){var e=m.a.bounds(t),n=(e.sw.lon,e.sw.lat,e.ne.lon,e.ne.lat,e.sw.lon),o=e.sw.lat,a=e.ne.lon,i=e.ne.lat,s={code:t,geom:[[[n,o],[a,o],[a,i],[n,i],[n,o]]]};this.gridParts.push(s);var r=m.a.decode(t),c={code:t,lng:r.lon,lat:r.lat};this.gridPoints.push(c)}},{key:"refreshData",value:function(){var t=this.getGridData();this.map.getSource("geohashGrid").setData(t.box),this.map.getSource("geohashPoint").setData(t.point)}}]),t}(),k=_,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mapInfo"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showSetting,expression:"showSetting"}],staticClass:"setting"},[n("span",[t._v("精度")]),n("el-input-number",{staticClass:"map-input",attrs:{"controls-position":"right",size:"mini",min:1,max:12},model:{value:t.precision,callback:function(e){t.precision=e},expression:"precision"}})],1),n("div",{staticClass:"content"},[n("div",[t._v(" 坐标:"+t._s(t.coord)+", ")]),n("div",[n("span",[t._v("geohash编码: "+t._s(t.geohashCode))]),n("div",{staticClass:"tools"},[n("Copy",{staticClass:"btn-items",attrs:{textStr:t.text}}),n("el-tooltip",{attrs:{content:"精度设置",placement:"top"}},[n("i",{staticClass:"el-icon-setting btn-item",on:{click:function(e){t.showSetting=!t.showSetting}}})])],1)])])])},I=[],P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"copyTool"},[n("el-tooltip",{attrs:{content:"复制",placement:"top"}},[n("i",{staticClass:"el-icon-document-copy btn-copy",on:{click:t.copyHandle}})])],1)},M=[],z={props:{textStr:{type:String,require:!0}},methods:{copyHandle:function(){C(this.textStr)}}},L=z,N=(n("25ff"),n("2877")),E=Object(N["a"])(L,P,M,!1,null,"3a63f9e4",null),B=E.exports,D={data:function(){return{geohashCode:"",coord:"",precision:5,showSetting:!1}},components:{Copy:B},computed:{text:function(){return"坐标:".concat(this.coord,",\n")+"geohash编码: ".concat(this.geohashCode)}},watch:{coord:function(t){this.convertCoordToCode(t)}},methods:{convertCoordToCode:function(t){if(t){var e=t.split(",").map((function(t){return parseFloat(t)}));this.geohashCode=m.a.encode(e[1],e[0],this.precision)}}}},T=D,q=(n("c42d"),Object(N["a"])(T,O,I,!1,null,"fbb2a1a6",null)),$=q.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"searchBox"},[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜geohash编码、经纬度"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},[n("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-search"},on:{click:t.searchHandle},slot:"append"})],1),t.boxInfoVisible?n("div",{staticClass:"searchResult"},[n("div",[n("i",{staticClass:"el-icon-close close",on:{click:t.closeHandle}})]),n("div",{staticClass:"content"},[n("li",[t._v("东经: "+t._s(t.bound.ne.lon)+"°")]),n("li",[t._v("西经: "+t._s(t.bound.sw.lon)+"°")]),n("li",[t._v("北纬: "+t._s(t.bound.ne.lat)+"°")]),n("li",[t._v("南纬: "+t._s(t.bound.sw.lat)+"°")]),n("Copy",{staticClass:"copyBar",attrs:{textStr:t.info}}),n("li",[t._v("中心点："+t._s(t.center.lon+"°, "+t.center.lat+"°"))])],1)]):t._e()],1)},J=[],U=(n("99af"),{data:function(){return{input:"",bound:{},center:[],boxInfoVisible:!1}},components:{Copy:B},computed:{info:function(){return"东经: ".concat(this.bound.ne.lon,"°\n")+"西经: ".concat(this.bound.sw.lon,"°\n")+"北纬: ".concat(this.bound.ne.lat,"°\n")+"南纬: ".concat(this.bound.sw.lat,"°\n")+"中心点：".concat(this.center.lon,"°, ").concat(this.center.lat,"°")}},watch:{boxInfoVisible:function(t){t||(this.bound={},this.center=[])}},methods:{searchHandle:function(){this.input&&(y(this.input)?this.$emit("search",{type:"coord",data:this.input}):w(this.input)&&(this.$emit("search",{type:"geohashCode",data:this.input}),this.showBoxInfo(this.input)))},showBoxInfo:function(t){this.bound=m.a.bounds(t),this.center=m.a.decode(t),this.boxInfoVisible=!0},closeHandle:function(){this.boxInfoVisible=!1,this.$emit("close",{type:"geohashCode",data:this.input})}}}),A=U,G=(n("4976"),Object(N["a"])(A,H,J,!1,null,"26e80008",null)),F=G.exports,V={data:function(){return{mapObj:null,marker:null,boxSourceId:"boxSource"}},components:{Info:$,Search:F},mounted:function(){this.init()},methods:{init:function(){var t=this;l.a.accessToken="pk.eyJ1IjoiaGlrZXI3IiwiYSI6ImNqd2J1bnAzMTAydmEzenBsYWNsdmNtbnEifQ.yIals3oQAWta-jougYrCNQ",l.a.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.1.0/mapbox-gl-rtl-text.js");var e=new l.a.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v10",center:[108.902344,33.661133],zoom:3,attributionControl:!1}),n=new d.a({defaultLanguage:"zh"});e.addControl(n),this.mapObj=e;new k({map:e});e.on("click",(function(e){t.dispatchEventMapClick(e)}))},addPopBoxLayer:function(t){var e={type:"geojson",data:t};this.mapObj.addSource(this.boxSourceId,e);var n={id:"searchBox",type:"fill",source:this.boxSourceId,layout:{},paint:{"fill-color":"#409eff","fill-opacity":.3}};this.mapObj.addLayer(n)},dispatchEventMapClick:function(t){this.$refs.tools&&(this.$refs.tools.coord=t.lngLat.toArray().join(",")),this.showMarker(t.lngLat)},mapSearchHandle:function(t){if("coord"===t.type){var e=g(t.data);this.showMarker(e),this.mapObj.flyTo({center:e,zoom:10})}else if("geohashCode"===t.type){var n=m.a.decode(t.data);if(n){var o=m.a.bounds(t.data),a=[o.sw.lon,o.sw.lat,o.ne.lon,o.ne.lat];this.showBox(a),this.mapObj.fitBounds([o.sw,o.ne],{padding:{top:25,bottom:25,left:15,right:15}})}}},showBox:function(t){var e=x(t);this.mapObj.getSource(this.boxSourceId)?this.mapObj.getSource(this.boxSourceId).setData(e):this.addPopBoxLayer(e)},showMarker:function(t){this.marker?this.marker.setLngLat(t):this.marker=(new l.a.Marker).setLngLat(t).addTo(this.mapObj)},clearPopHandle:function(){if(this.mapObj.getSource(this.boxSourceId)){var t="wq517dd923zz",e=m.a.bounds(t),n=[e.sw.lon,e.sw.lat,e.ne.lon,e.ne.lat],o=x(n);this.mapObj.getSource(this.boxSourceId).setData(o)}}}},Q=V,R=(n("e9f0"),Object(N["a"])(Q,s,r,!1,null,"3947eff0",null)),Z=R.exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.aw?n("div",{staticClass:"icp"},[n("a",{attrs:{href:"http://beian.miit.gov.cn/"}},[t._v(t._s(t.icpKey[0]))])]):t._e()},K=[],Y={data:function(){return{aw:"",key1:"JUU3JUIyJUE0SUNQJUU1JUE0JTg3MjAyMDEyOTMxOSVFNSU4RiVCNw==",key2:"aHR0cDovL2JlaWFuLm1paXQuZ292LmNu",icpKey:[]}},watch:{aw:function(t){t&&(this.icpKey=[this.key1,this.key1].map((function(t){return S(t)})))}},mounted:function(){this.init()},methods:{init:function(){this.aw=1}}},X=Y,tt=(n("b2dd"),Object(N["a"])(X,W,K,!1,null,"96b0806c",null)),et=tt.exports,nt={name:"app",components:{Main:Z,Foot:et}},ot=nt,at=(n("7c55"),Object(N["a"])(ot,a,i,!1,null,null,null)),it=at.exports,st=(n("ac6d"),n("0c67"),n("450d"),n("299c")),rt=n.n(st),ct=(n("1951"),n("eedf")),lt=n.n(ct),ut=(n("9d4c"),n("e450")),dt=n.n(ut),ht=(n("10cb"),n("f3ad")),pt=n.n(ht),ft=(n("f4f9"),n("c2cc")),mt=n.n(ft),bt=(n("7a0f"),n("0f6c")),vt=n.n(bt);n("0fae");o["default"].use(vt.a),o["default"].use(mt.a),o["default"].use(pt.a),o["default"].use(dt.a),o["default"].use(lt.a),o["default"].use(rt.a),o["default"].config.productionTip=!1,new o["default"]({render:function(t){return t(it)}}).$mount("#app")},5958:function(t,e,n){},"7c55":function(t,e,n){"use strict";n("2395")},8574:function(t,e,n){},"905b":function(t,e,n){},9383:function(t,e,n){},b2dd:function(t,e,n){"use strict";n("9383")},c42d:function(t,e,n){"use strict";n("8574")},c851:function(t,e,n){},e9f0:function(t,e,n){"use strict";n("905b")},eb43:function(t,e,n){"use strict";var o,a;n("a9e3"),n("b680"),n("fb6a");var i={base32:"0123456789bcdefghjkmnpqrstuvwxyz",encode:function(t,e,n){if("undefined"==typeof n){for(var o=1;o<=12;o++){var a=i.encode(t,e,o),s=i.decode(a);if(s.lat==t&&s.lon==e)return a}n=12}if(t=Number(t),e=Number(e),n=Number(n),isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Invalid geohash");var r=0,c=0,l=!0,u="",d=-90,h=90,p=-180,f=180;while(u.length<n){if(l){var m=(p+f)/2;e>m?(r=2*r+1,p=m):(r*=2,f=m)}else{var b=(d+h)/2;t>b?(r=2*r+1,d=b):(r*=2,h=b)}l=!l,5==++c&&(u+=i.base32.charAt(r),c=0,r=0)}return u},decode:function(t){var e=i.bounds(t),n=e.sw.lat,o=e.sw.lon,a=e.ne.lat,s=e.ne.lon,r=(n+a)/2,c=(o+s)/2;return r=r.toFixed(Math.floor(2-Math.log(a-n)/Math.LN10)),c=c.toFixed(Math.floor(2-Math.log(s-o)/Math.LN10)),{lat:Number(r),lon:Number(c)}},bounds:function(t){if(0===t.length)throw new Error("Invalid geohash");t=t.toLowerCase();for(var e=!0,n=-90,o=90,a=-180,s=180,r=0;r<t.length;r++){var c=t.charAt(r),l=i.base32.indexOf(c);if(-1==l)throw new Error("Invalid geohash");for(var u=4;u>=0;u--){var d=l>>u&1;if(e){var h=(a+s)/2;1==d?a=h:s=h}else{var p=(n+o)/2;1==d?n=p:o=p}e=!e}}var f={sw:{lat:n,lon:a},ne:{lat:o,lon:s}};return f},adjacent:function(t,e){if(t=t.toLowerCase(),e=e.toLowerCase(),0===t.length)throw new Error("Invalid geohash");if(-1=="nsew".indexOf(e))throw new Error("Invalid direction");var n={n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]},o={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]},a=t.slice(-1),s=t.slice(0,-1),r=t.length%2;return-1!=o[e][r].indexOf(a)&&""!==s&&(s=i.adjacent(s,e)),s+i.base32.charAt(n[e][r].indexOf(a))},neighbours:function(t){return{n:i.adjacent(t,"n"),ne:i.adjacent(i.adjacent(t,"n"),"e"),e:i.adjacent(t,"e"),se:i.adjacent(i.adjacent(t,"s"),"e"),s:i.adjacent(t,"s"),sw:i.adjacent(i.adjacent(t,"s"),"w"),w:i.adjacent(t,"w"),nw:i.adjacent(i.adjacent(t,"n"),"w")}}};t.exports&&(t.exports=i),o=[],a=function(){return i}.apply(e,o),void 0===a||(t.exports=a)}});