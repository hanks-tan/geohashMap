(function(t){function e(e){for(var o,i,r=e[0],c=e[1],l=e[2],h=0,u=[];h<r.length;h++)i=r[h],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&u.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(u.length)u.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],o=!0,r=1;r<a.length;r++){var c=a[r];0!==n[c]&&(o=!1)}o&&(s.splice(e--,1),t=i(i.s=a[0]))}return t}var o={},n={index:0},s=[];function i(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=o,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(a,o,function(e){return t[e]}.bind(null,o));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var d=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0cae":function(t,e,a){"use strict";var o=a("e022"),n=a.n(o);e["default"]=n.a},"18c9":function(t,e,a){},"1b9e":function(t,e,a){},"1f3c":function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return n}));var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("a",{staticClass:"github-corner",attrs:{href:"https://github.com/hanks-tan/geohashMap","aria-label":"View source on GitHub"}},[e("svg",{staticStyle:{fill:"#64CEAA",color:"#000",position:"absolute",top:"0",border:"0",right:"0"},attrs:{width:"80",height:"80",viewBox:"0 0 250 250","aria-hidden":"true"}},[e("path",{attrs:{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}}),e("path",{staticClass:"octo-arm",staticStyle:{"transform-origin":"130px 106px"},attrs:{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}}),e("path",{staticClass:"octo-body",attrs:{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"}})])])])},n=[]},"266a":function(t,e,a){"use strict";a("97c9")},"2c1f":function(t,e,a){"use strict";a("1b9e")},"56d7":function(t,e,a){"use strict";a.r(e);var o=a("a026"),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Main"),e("Foot")],1)},s=[],i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[e("div",{staticClass:"map",attrs:{id:"map"}}),e("GH"),e("Search",{staticClass:"searchBar",on:{search:t.mapSearchHandle,close:t.clearPopHandle}}),e("Info",{ref:"tools",staticClass:"info"})],1)},r=[],c=(a("0643"),a("cbc8"),a("e192")),l=a.n(c),d=a("5a74"),h=a.n(d),u=(a("14d9"),a("a573"),a("eb43")),p=a.n(u),f=a("fc4e"),b=a.n(f);a("5b81"),a("b7ef");function m(t,e){e||(e=",");let a=t.split(e).map(t=>parseInt(t));return a}function g(t){if(!t instanceof String)return!1;t=t.replaceAll(" ","");let e=/^[-\+]?\d+(\.\d+)?\,[-\+]?\d+(\.\d+)?$/,a=t.match(e);return a}function v(t){return!!p.a.decode(t)}function y(t){let e={geom:[[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]],[t[0],t[1]]]]};return b.a.parse([e],{Polygon:"geom"})}function x(t,e,a){let o=b.a.parse(t,{Point:[a,e]});return o}function w(t){if(navigator.clipboard.writeText(t),navigator.clipboard)navigator.clipboard.writeText(t);else{const e=document.createElement("textarea");document.body.appendChild(e),e.value=t,e.select(),document.execCommand&&document.execCommand("copy"),document.body.removeChild(e)}}function C(t){return decodeURIComponent(atob(t))}class j{constructor(t){this.map=t.map,this._layer=void 0,this.defaults={zoom:3,maxDisplay:10240,geohashPrecision:12,geohashZoomScale:[1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9]},this.gridParts=[],this.gridPoints=[],this._layers={},this.map&&this.map.on("load",()=>{this.init()})}init(){let t=this.getGridData();this.map.addSource("geohashPoint",{type:"geojson",data:t.point}),this.map.addSource("geohashGrid",{type:"geojson",data:t.box});let e={id:"geohashPointLayer",source:"geohashPoint",type:"symbol",layout:{"text-field":"{code}","text-anchor":"center","text-size":12}},a={id:"geohashGridLayer",source:"geohashGrid",type:"fill",layout:{},paint:{"fill-color":"#088","fill-opacity":.2,"fill-outline-color":"#007bff"}};this.map.addLayer(a),this.map.addLayer(e),this._layers={point:e,polygon:a},this.map.on("load",()=>{this.refreshData()}),this.map.on("moveend",()=>{this.refreshData()})}getGridData(){this.gridParts=[],this.gridPoints=[];let t=this.map.getZoom(),e=Math.round(t),a=this.defaults.geohashZoomScale[e],o=this.map.getBounds(),n=o.getWest(),s=o.getSouth(),i=o.getEast(),r=o.getNorth(),c=p.a.encode(r,i,a),l=p.a.encode(r,n,a),d=p.a.encode(s,n,a),h=(p.a.encode(s,i,a),c),u=c,f=l,m=this.defaults.maxDisplay;while(m-- >0){this.drawBox(h);do{h=p.a.adjacent(h,"w"),this.drawBox(h)}while(m-- >0&&h!=f);if(h==d){let t=b.a.parse(this.gridParts,{Polygon:"geom"}),e=x(this.gridPoints,"lng","lat");return{point:e,box:t}}f=p.a.adjacent(h,"s"),h=u=p.a.adjacent(u,"s")}alert("defaults.maxDisplay limit reached")}drawBox(t){const e=p.a.bounds(t),a=(e.sw.lon,e.sw.lat,e.ne.lon,e.ne.lat,e.sw.lon),o=e.sw.lat,n=e.ne.lon,s=e.ne.lat;let i={code:t,geom:[[[a,o],[n,o],[n,s],[a,s],[a,o]]]};this.gridParts.push(i);let r=p.a.decode(t),c={code:t,lng:r.lon,lat:r.lat};this.gridPoints.push(c)}refreshData(){let t=this.getGridData();this.map.getSource("geohashGrid").setData(t.box),this.map.getSource("geohashPoint").setData(t.point)}}var S=j,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mapInfo"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showSetting,expression:"showSetting"}],staticClass:"setting"},[e("span",[t._v("精度")]),e("el-input-number",{staticClass:"map-input",attrs:{"controls-position":"right",size:"mini",min:1,max:12},model:{value:t.precision,callback:function(e){t.precision=e},expression:"precision"}})],1),e("div",{staticClass:"content"},[e("div",[t._v(" 坐标:"+t._s(t.coord)+", ")]),e("div",[e("span",[t._v("geohash编码: "+t._s(t.geohashCode))]),e("div",{staticClass:"tools"},[e("Copy",{staticClass:"btn-items",attrs:{textStr:t.text}}),e("el-tooltip",{attrs:{content:"精度设置",placement:"top"}},[e("i",{staticClass:"el-icon-setting btn-item",on:{click:function(e){t.showSetting=!t.showSetting}}})])],1)])])])},k=[],O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"copyTool"},[e("el-tooltip",{attrs:{content:"复制",placement:"top"}},[e("i",{staticClass:"el-icon-document-copy btn-copy",on:{click:t.copyHandle}})])],1)},M=[],I={props:{textStr:{type:String,require:!0}},methods:{copyHandle(){w(this.textStr)}}},L=I,P=(a("a475"),a("2877")),T=Object(P["a"])(L,O,M,!1,null,"3a63f9e4",null),z=T.exports,N={data(){return{geohashCode:"",coord:"",precision:5,showSetting:!1}},components:{Copy:z},computed:{text(){return`坐标:${this.coord},\ngeohash编码: `+this.geohashCode}},watch:{coord(t){this.convertCoordToCode(t)}},methods:{convertCoordToCode(t){if(t){let e=t.split(",").map(t=>parseFloat(t));this.geohashCode=p.a.encode(e[1],e[0],this.precision)}}}},B=N,E=(a("dd4d"),Object(P["a"])(B,_,k,!1,null,"fbb2a1a6",null)),D=E.exports,H=function(){var t=this,e=t._self._c;return e("div",{staticClass:"searchBox"},[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:"搜geohash编码、经纬度"},on:{change:t.searchHandle},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},[e("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-search"},on:{click:t.searchHandle},slot:"append"})],1),t.boxInfoVisible?e("div",{staticClass:"searchResult"},[e("div",[e("i",{staticClass:"el-icon-close close",on:{click:t.closeHandle}})]),"geohashCode"===t.searchType?e("div",{staticClass:"content"},[e("li",[t._v("东经: "+t._s(t.bound.ne.lon)+"°")]),e("li",[t._v("西经: "+t._s(t.bound.sw.lon)+"°")]),e("li",[t._v("北纬: "+t._s(t.bound.ne.lat)+"°")]),e("li",[t._v("南纬: "+t._s(t.bound.sw.lat)+"°")]),e("Copy",{staticClass:"copyBar",attrs:{textStr:t.info}}),e("li",[t._v("中心点："+t._s(`${t.center.lon}°, ${t.center.lat}°`))])],1):"coord"===t.searchType?e("div",{staticClass:"content"},[e("span",[t._v(" geohash编码："+t._s(t.searchTextResult)+" ")]),e("Copy",{staticClass:"copyBar",attrs:{textStr:t.info}})],1):t._e()]):t._e()],1)},$=[],q={data(){return{input:"",bound:{},center:[],boxInfoVisible:!1,searchType:"",searchTextResult:""}},components:{Copy:z},computed:{info(){return"geohashcode"===this.searchType?`东经: ${this.bound.ne.lon}°\n西经: ${this.bound.sw.lon}°\n北纬: ${this.bound.ne.lat}°\n南纬: ${this.bound.sw.lat}°\n中心点：${this.center.lon}°, ${this.center.lat}°`:("coord"===this.searchType&&this.searchTextResult,"")}},watch:{boxInfoVisible(t){t||(this.bound={},this.center=[])}},methods:{searchHandle(){this.input&&(g(this.input)?this.searchType="coord":v(this.input)&&(this.searchType="geohashCode"),this.showBoxInfo(this.input,this.searchType),this.$emit("search",{type:this.searchType,data:this.input}))},showBoxInfo(t,e){if("coord"===e){let e=m(t);this.searchTextResult=p.a.encode(e[1],e[0])}else"geohashCode"===e&&(this.bound=p.a.bounds(t),this.center=p.a.decode(t));this.boxInfoVisible=!0},closeHandle(){this.boxInfoVisible=!1,this.$emit("close")}}},A=q,G=(a("266a"),Object(P["a"])(A,H,$,!1,null,"3d4b5bdc",null)),J=G.exports,U=a("95d1"),R={data(){return{mapObj:null,markers:{searchMarker:null,evtMarker:null},markerColors:{searchMarker:"#f74e4e",evtMarker:"#3FB1CE"},boxSourceId:"boxSource"}},components:{Info:D,Search:J,GH:U["default"]},mounted(){this.init()},methods:{init(){l.a.accessToken="pk.eyJ1IjoiaGlrZXI3IiwiYSI6ImNqd2J1bnAzMTAydmEzenBsYWNsdmNtbnEifQ.yIals3oQAWta-jougYrCNQ",l.a.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.1.0/mapbox-gl-rtl-text.js");const t=new l.a.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v10",center:[108.902344,33.661133],zoom:3,attributionControl:!1});let e=new h.a({defaultLanguage:"zh"});t.addControl(e),this.mapObj=t;new S({map:t});t.on("click",t=>{this.dispatchEventMapClick(t)})},addPopBoxLayer(t){let e={type:"geojson",data:t};this.mapObj.addSource(this.boxSourceId,e);let a={id:"searchBox",type:"fill",source:this.boxSourceId,layout:{},paint:{"fill-color":"#409eff","fill-opacity":.3}};this.mapObj.addLayer(a)},dispatchEventMapClick(t){this.$refs.tools&&(this.$refs.tools.coord=t.lngLat.toArray().join(",")),this.showMarker(t.lngLat,"evtMarker")},mapSearchHandle(t){if("coord"===t.type){let e=m(t.data);this.showMarker(e,"searchMarker"),this.mapObj.flyTo({center:e,zoom:10})}else if("geohashCode"===t.type){let e=p.a.decode(t.data);if(e){let e=p.a.bounds(t.data);const a=[e.sw.lon,e.sw.lat,e.ne.lon,e.ne.lat];this.showBox(a),this.mapObj.fitBounds([e.sw,e.ne],{padding:{top:25,bottom:25,left:15,right:15}})}}},showBox(t){let e=y(t);this.mapObj.getSource(this.boxSourceId)?this.mapObj.getSource(this.boxSourceId).setData(e):this.addPopBoxLayer(e)},showMarker(t,e){this.markers[e]?this.markers[e].setLngLat(t):this.markers[e]=new l.a.Marker({color:this.markerColors[e]}).setLngLat(t).addTo(this.mapObj)},clearPopHandle(t){if(this.markers[t.type]&&this.markers[t.type].remove(),this.mapObj.getSource(this.boxSourceId)){const t="wq517dd923zz",e=p.a.bounds(t),a=[e.sw.lon,e.sw.lat,e.ne.lon,e.ne.lat],o=y(a);this.mapObj.getSource(this.boxSourceId).setData(o)}}}},F=R,V=(a("2c1f"),Object(P["a"])(F,i,r,!1,null,"478a52c6",null)),Z=V.exports,Q=function(){var t=this,e=t._self._c;return t.aw?e("div",{staticClass:"icp"},[e("a",{attrs:{href:"http://beian.miit.gov.cn/"}},[t._v(t._s(t.icpKey[0]))])]):t._e()},W=[],K={data(){return{aw:"",key1:"JUU3JUIyJUE0SUNQJUU1JUE0JTg3MjAyMDEyOTMxOSVFNSU4RiVCNw==",key2:"aHR0cDovL2JlaWFuLm1paXQuZ292LmNu",icpKey:[]}},watch:{aw(t){t&&(this.icpKey=[this.key1,this.key1].map(t=>C(t)))}},mounted(){this.init()},methods:{init(){this.aw=1}}},Y=K,X=(a("8674"),Object(P["a"])(Y,Q,W,!1,null,"96b0806c",null)),tt=X.exports,et={name:"app",components:{Main:Z,Foot:tt}},at=et,ot=(a("a3a9"),Object(P["a"])(at,n,s,!1,null,null,null)),nt=ot.exports,st=(a("ac6d"),a("0c67"),a("450d"),a("299c")),it=a.n(st),rt=(a("1951"),a("eedf")),ct=a.n(rt),lt=(a("9d4c"),a("e450")),dt=a.n(lt),ht=(a("10cb"),a("f3ad")),ut=a.n(ht),pt=(a("f4f9"),a("c2cc")),ft=a.n(pt),bt=(a("7a0f"),a("0f6c")),mt=a.n(bt);a("0fae");o["default"].use(mt.a),o["default"].use(ft.a),o["default"].use(ut.a),o["default"].use(dt.a),o["default"].use(ct.a),o["default"].use(it.a),o["default"].config.productionTip=!1,new o["default"]({render:t=>t(nt)}).$mount("#app")},"74cd":function(t,e,a){},8674:function(t,e,a){"use strict";a("b8e9")},"95d1":function(t,e,a){"use strict";var o=a("1f3c"),n=a("0cae"),s=(a("fcab"),a("2877")),i=Object(s["a"])(n["default"],o["a"],o["b"],!1,null,null,null);e["default"]=i.exports},"97c9":function(t,e,a){},"9b34":function(t,e,a){},a3a9:function(t,e,a){"use strict";a("74cd")},a475:function(t,e,a){"use strict";a("db52")},b8e9:function(t,e,a){},db52:function(t,e,a){},dd4d:function(t,e,a){"use strict";a("18c9")},e022:function(t,e){},eb43:function(t,e,a){"use strict";var o,n;a("d9e2");var s={base32:"0123456789bcdefghjkmnpqrstuvwxyz",encode:function(t,e,a){if("undefined"==typeof a){for(var o=1;o<=12;o++){var n=s.encode(t,e,o),i=s.decode(n);if(i.lat==t&&i.lon==e)return n}a=12}if(t=Number(t),e=Number(e),a=Number(a),isNaN(t)||isNaN(e)||isNaN(a))throw new Error("Invalid geohash");var r=0,c=0,l=!0,d="",h=-90,u=90,p=-180,f=180;while(d.length<a){if(l){var b=(p+f)/2;e>b?(r=2*r+1,p=b):(r*=2,f=b)}else{var m=(h+u)/2;t>m?(r=2*r+1,h=m):(r*=2,u=m)}l=!l,5==++c&&(d+=s.base32.charAt(r),c=0,r=0)}return d},decode:function(t){var e=s.bounds(t),a=e.sw.lat,o=e.sw.lon,n=e.ne.lat,i=e.ne.lon,r=(a+n)/2,c=(o+i)/2;return r=r.toFixed(Math.floor(2-Math.log(n-a)/Math.LN10)),c=c.toFixed(Math.floor(2-Math.log(i-o)/Math.LN10)),{lat:Number(r),lon:Number(c)}},bounds:function(t){if(0===t.length)throw new Error("Invalid geohash");t=t.toLowerCase();for(var e=!0,a=-90,o=90,n=-180,i=180,r=0;r<t.length;r++){var c=t.charAt(r),l=s.base32.indexOf(c);if(-1==l)throw new Error("Invalid geohash");for(var d=4;d>=0;d--){var h=l>>d&1;if(e){var u=(n+i)/2;1==h?n=u:i=u}else{var p=(a+o)/2;1==h?a=p:o=p}e=!e}}var f={sw:{lat:a,lon:n},ne:{lat:o,lon:i}};return f},adjacent:function(t,e){if(t=t.toLowerCase(),e=e.toLowerCase(),0===t.length)throw new Error("Invalid geohash");if(-1=="nsew".indexOf(e))throw new Error("Invalid direction");var a={n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]},o={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]},n=t.slice(-1),i=t.slice(0,-1),r=t.length%2;return-1!=o[e][r].indexOf(n)&&""!==i&&(i=s.adjacent(i,e)),i+s.base32.charAt(a[e][r].indexOf(n))},neighbours:function(t){return{n:s.adjacent(t,"n"),ne:s.adjacent(s.adjacent(t,"n"),"e"),e:s.adjacent(t,"e"),se:s.adjacent(s.adjacent(t,"s"),"e"),s:s.adjacent(t,"s"),sw:s.adjacent(s.adjacent(t,"s"),"w"),w:s.adjacent(t,"w"),nw:s.adjacent(s.adjacent(t,"n"),"w")}}};t.exports&&(t.exports=s),o=[],n=function(){return s}.apply(e,o),void 0===n||(t.exports=n)},fcab:function(t,e,a){"use strict";a("9b34")}});